<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Benjamin Guiastrennec" />


<title>Access the xpdb data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Access the xpdb data</h1>
<h4 class="author"><em>Benjamin Guiastrennec</em></h4>
<h4 class="date"><em>14 November, 2017</em></h4>



<p>The xpose package was designed as a standardized interface between model outputs and R. Hence model output files can easily be imported in R and used to summarize data or create plots.</p>
<div id="glimpse-at-the-xpdb" class="section level3">
<h3>Glimpse at the xpdb</h3>
<p>The files attached to an xpdb object can be displayed to the console simply by writing the xpdb name to the console or by using the <code>print()</code> function. Any of these files can be accessed from the xpdb using one of the functions listed below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xpdb <span class="co"># or print(xpdb)</span></code></pre></div>
<pre><code>run001.lst overview: 
 - Software: nonmem 7.3.0 
 - Attached files (memory usage 1.3 Mb): 
   + obs tabs: $prob no.1: catab001.csv, cotab001, patab001, sdtab001 
   + sim tabs: $prob no.2: simtab001.zip 
   + output files: run001.cor, run001.cov, run001.ext, run001.grd, run001.phi, run001.shk 
   + special: &lt;none&gt; 
 - gg_theme: theme_readable 
 - xp_theme: theme_xp_default 
 - Options: dir = analysis/models/pk/, quiet = FALSE, manual_import = NULL</code></pre>
</div>
<div id="access-the-model-code" class="section level3">
<h3>Access the model code</h3>
<p>The <code>get_code()</code> function can be used to access the parsed model code from the xpdb. This code was used to create the summary and find table names. The parsed code can be used to get additional information about the run. If the argument <code>.problem</code> is specified a subset of the code can be returned based on <code>$PROBLEM</code>.</p>
<p><em>Note that general code warnings and PsN outputs appended are listed as problem 0.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">code &lt;-<span class="st"> </span><span class="kw">get_code</span>(xpdb)
code</code></pre></div>
<pre><code># A tibble: 764 x 5
   problem level subroutine                                                   code
 *   &lt;int&gt; &lt;int&gt;      &lt;chr&gt;                                                  &lt;chr&gt;
 1       0     0        oth                          Mon Oct 16 13:34:28 CEST 2017
 2       0     0        oth                                                       
 3       0     0        oth                                                       
 4       0     0        oth                                                       
 5       1     1        pro                                   Parameter estimation
 6       1     2        inp ID DOSE DV SCR AGE SEX CLASS WT ACE MED1 MED2 TAD TIME
 7       1     2        inp                                    CLCR AMT SS II EVID
 8       1     3        dat                              ../../mx19_2.csv IGNORE=@
 9       1     4        abb                                              DERIV2=NO
10       1     5        sub                                          ADVAN2 TRANS1
# ... with 754 more rows, and 1 more variables: comment &lt;chr&gt;</code></pre>
</div>
<div id="access-the-output-data" class="section level3">
<h3>Access the output data</h3>
<p>The <code>get_data()</code> function can be used to access the imported table files. Tables can be accessed by <code>table</code> name or by <code>.problem</code>. In the latter a single dataset containing all aggregated tables is returned. If more than one <code>table</code> name or <code>.problem</code> number is provided a named list is returned.</p>
<p><em>Note when providing a table name it is not guaranteed that the table will be identical to its file (i.e. the order of the columns may have been changed and tables with <code>FIRSTONLY</code> will no longer be deduplicated).</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">get_data</span>(xpdb, <span class="dt">table =</span> <span class="st">'cotab001'</span>)
data</code></pre></div>
<pre><code># A tibble: 550 x 4
       ID  CLCR   AGE    WT
   &lt;fctr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1    110    66    68   105
 2    110    66    68   105
 3    110    66    68   105
 4    110    66    68   105
 5    110    66    68   105
 6    110    66    68   105
 7    110    66    68   105
 8    112    47    73    80
 9    112    47    73    80
10    112    47    73    80
# ... with 540 more rows</code></pre>
</div>
<div id="access-the-run-files" class="section level3">
<h3>Access the run files</h3>
<p>The <code>get_file()</code> function can be used to access the imported output files. Files can be accessed by <code>file</code> name, by <code>.problem</code>, <code>.subprob</code> and/or <code>.method</code>. If more than one <code>file</code> name, <code>.problem</code>, <code>.subprob</code>, or <code>.method</code> is provided a named list is returned.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">file &lt;-<span class="st"> </span><span class="kw">get_file</span>(xpdb, <span class="dt">file =</span> <span class="st">'run001.ext'</span>)
file</code></pre></div>
<pre><code># A tibble: 28 x 16
   ITERATION  THETA1  THETA2  THETA3   THETA4   THETA5     THETA6     THETA7 `SIGMA(1,1)`
       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
 1         0 25.3535 1.46525 7.45219 0.214386 0.200119 0.00982739 0.00600636            1
 2         1 26.3257 1.26115 7.34822 0.218727 0.217040 0.00988562 0.00602074            1
 3         2 25.6334 1.46525 7.29462 0.215628 0.212214 0.00987192 0.00602702            1
 4         3 26.7952 1.48967 5.76180 0.213014 0.213097 0.00978966 0.00628043            1
 5         4 26.6949 1.48849 5.69320 0.213037 0.212436 0.00978746 0.00629408            1
 6         5 26.7278 1.48841 5.66352 0.213025 0.211937 0.00979166 0.00630166            1
 7         6 26.6462 1.49205 5.02679 0.209907 0.217267 0.01000230 0.00651552            1
 8         7 26.6205 1.48806 4.92877 0.205327 0.217191 0.01000980 0.00657615            1
 9         8 26.5629 1.47648 4.62271 0.210903 0.216647 0.00951367 0.00735274            1
10         9 26.5577 1.45700 4.41353 0.209440 0.216923 0.00903287 0.00873910            1
# ... with 18 more rows, and 7 more variables: `OMEGA(1,1)` &lt;dbl&gt;, `OMEGA(2,1)` &lt;dbl&gt;,
#   `OMEGA(2,2)` &lt;dbl&gt;, `OMEGA(3,1)` &lt;dbl&gt;, `OMEGA(3,2)` &lt;dbl&gt;, `OMEGA(3,3)` &lt;dbl&gt;, OBJ &lt;dbl&gt;</code></pre>
</div>
<div id="access-the-parameter-estimates" class="section level3">
<h3>Access the parameter estimates</h3>
<p>The <code>get_prm()</code> function can be used to access the parameter estimates. To get a nice parameter table printed to the console use the function <code>prm_table()</code> instead. The arguments <code>.problem</code>, <code>.subprob</code> and <code>.method</code> can be used to select the parameter estimates to output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Raw output for editing</span>
prm &lt;-<span class="st"> </span><span class="kw">get_prm</span>(xpdb, <span class="dt">digits =</span> <span class="dv">4</span>)
prm</code></pre></div>
<pre><code># A tibble: 11 x 10
    type       name      label     value       se     rse fixed diagonal     m     n
 * &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;lgl&gt;    &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1   the     THETA1       TVCL 26.290000 0.891500 0.03391 FALSE       NA     1    NA
 2   the     THETA2        TVV  1.348000 0.043810 0.03250 FALSE       NA     2    NA
 3   the     THETA3       TVKA  4.204000 0.809100 0.19250 FALSE       NA     3    NA
 4   the     THETA4        LAG  0.208000 0.015710 0.07554 FALSE       NA     4    NA
 5   the     THETA5  Prop. Err  0.204600 0.022440 0.10970 FALSE       NA     5    NA
 6   the     THETA6   Add. Err  0.010550 0.003658 0.34660 FALSE       NA     6    NA
 7   the     THETA7 CRCL on CL  0.007172 0.001697 0.23660 FALSE       NA     7    NA
 8   ome OMEGA(1,1)     IIV CL  0.270100 0.023270 0.08616 FALSE     TRUE     1     1
 9   ome OMEGA(2,2)      IIV V  0.195000 0.032040 0.16430 FALSE     TRUE     2     2
10   ome OMEGA(3,3)     IIV KA  1.381000 0.202100 0.14630 FALSE     TRUE     3     3
11   sig SIGMA(1,1)             1.000000       NA      NA  TRUE     TRUE     1     1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Nicely formated table</span>
<span class="kw">prm_table</span>(xpdb, <span class="dt">digits =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>
The relative standard errors for omega and sigma are reported on the approximate
standard deviation scale (SE/variance estimate)/2.

Estimates for $prob no.1, subprob no.0, method foce
 Parameter  Label      Value        RSE
 THETA1     TVCL       26.29        0.03391
 THETA2     TVV        1.348        0.0325
 THETA3     TVKA       4.204        0.1925
 THETA4     LAG        0.208        0.07554
 THETA5     Prop. Err  0.2046       0.1097
 THETA6     Add. Err   0.01055      0.3466
 THETA7     CRCL on CL 0.007172     0.2366
 OMEGA(1,1) IIV CL     0.2701       0.08616
 OMEGA(2,2) IIV V      0.195        0.1643
 OMEGA(3,3) IIV KA     1.381        0.1463
 SIGMA(1,1)            1        fix  - </code></pre>
</div>
<div id="access-the-run-summary" class="section level3">
<h3>Access the run summary</h3>
<p>The <code>get_summary()</code> function can be used to access the generated run summary from which the <code>template_titles</code>. If the argument <code>.problem</code> is specified a subset of the summary can be returned based on <code>$PROBLEM</code>.</p>
<p><em>Note that general summary information are listed as problem 0.</em></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">run_sum &lt;-<span class="st"> </span><span class="kw">get_summary</span>(xpdb, <span class="dt">.problem =</span> <span class="dv">0</span>)
run_sum</code></pre></div>
<pre><code># A tibble: 12 x 5
   problem subprob               descr       label                         value
     &lt;dbl&gt;   &lt;dbl&gt;               &lt;chr&gt;       &lt;chr&gt;                         &lt;chr&gt;
 1       0       0     Run description       descr   NONMEM PK example for xpose
 2       0       0       Run directory         dir           analysis/models/pk/
 3       0       0          Run errors      errors                            na
 4       0       0 ESAMPLE seed number esampleseed                            na
 5       0       0            Run file        file                    run001.lst
 6       0       0   Number of ESAMPLE    nesample                            na
 7       0       0     Reference model         ref                           000
 8       0       0          Run number         run                        run001
 9       0       0            Software    software                        nonmem
10       0       0      Run start time   timestart Mon Oct 16 13:34:28 CEST 2017
11       0       0       Run stop time    timestop Mon Oct 16 13:34:35 CEST 2017
12       0       0    Software version     version                         7.3.0</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
